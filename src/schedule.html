<main id="schedule">
  <!-- The display: none will be automatically removed once the details are filled in -->
  <div id="ms-schedule-info" style="display: none">
    <h1>Hi <span id="ms-participant"></span></h1>
    <p>You have been invited to a meeting by <span class="text-emp" id="ms-organizer"></span>.</p>
    <blockquote><span id="ms-description"></span></blockquote>
    <p><span id="ms-regularity"></span></p>
    <p><span id="ms-timezone"></span></p>
  </div>

  <div>
    <h2>Suggested time slots</h2>
    <p>Here are two suggested time slots that might work for you. You can also select a time slot from the calendar below.</p>
    <div id="ms-schedule-suggested">
      <!-- This will be generated using js -->
    </div>
  </div>

  <div id="ms-schedule-container">
    <h2>Available time slots</h2>
    <table id="ms-schedule-calendar">
      <!-- Due to the complexity of the table's html, it will be generated using js and placed here -->
    </table>
  </div>
</main>

<script>
  // On page load, get the invitation parameters from the url
  $(document).ready(function () {

    // Calculate days for the calendar
    const nDays = inv.availability.length

    // Get suggested times: Find two random time slots that are available
    const suggestedPool = [];
    for (let day = 0; day < nDays; day++) {
      for (let interval = 0; interval < 24 * 4; interval++) {
        // Ignore non-available intervals
        const avail = inv.availability[day][interval]
        if (avail === 0) continue;

        let end = interval + 1;
        while (end < 24 * 4 && inv.availability[day][end] !== 0) end++;

        // Check if the interval is long enough
        if (end - interval < inv.duration / 15) continue;

        // Add to the pool
        suggestedPool.push({day, interval});

        // Skip to the next duration
        interval += inv.duration / 15;
      }
    }

    // Pick two random time slots from the pool, show them as cards
    // TODO: Sort by preference
    const suggested = shuffle(suggestedPool).slice(0, 2);
    let tmpHtml = '';
    for (const {day, interval} of suggested) {
      // Get the date and time
      const date = ;
      const time = ``;

      tmpHtml += `
<div class="suggested-card" data-day="${day}" data-interval="${interval}">
  <div>
    <span class="date">${date}</span>
    <span class="time">${time}</span>
  </div>
  <button class="emp">Select</button>
</div>`;
    }
    $("#ms-schedule-suggested").html(tmpHtml);

    // Generate the calendar
    fillScheduleView({...inv, nDays, mountPoint: "#ms-schedule-calendar"})
  });
</script>